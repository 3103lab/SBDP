# SimpleBinaryDictionaryProtocol (SBDP)

SimpleBinaryDictionaryProtocol (SBDP) は、軽量で効率的なバイナリ形式のキー・バリュープロトコルです。組込みシステムや高性能ネットワーク通信に適した構造を提供します。

## プロトコル概要

SBDP の各メッセージは、以下の構造を持ちます。

```
[全体ペイロード長 (4バイト)] + [ペイロード本体]
```

- **全体ペイロード長**は、ペイロード部分の総バイト数を表す 4 バイトの unsigned integer（ネットワークバイトオーダー、big endian）です。

---

## ペイロード構造

ペイロードは複数の「キー・バリュー」ペアから構成されます。各ペアは以下の順に並びます：

```
[キー長 (2バイト)] + [キー文字列] + [型コード (1バイト)] + [値]
```

### キー部

| 項目        | 内容                            |
|-------------|---------------------------------|
| キー長      | 2バイトの unsigned int（ネットワークオーダー） |
| キー文字列  | UTF-8 でエンコードされた文字列               |
| 型コード    | 値の型を表す1バイトの識別子                |

### 型コード定義

| 型コード | データ型              | 内容                                      |
|----------|-----------------------|-------------------------------------------|
| `0x01`   | `int64`              | 8バイト、符号付き64ビット整数（big endian） |
| `0x02`   | `uint64`             | 8バイト、符号なし64ビット整数（big endian） |
| `0x03`   | `float64`            | 8バイト、IEEE754形式（big endian）         |
| `0x04`   | `string`             | 下記「可変長文字列」形式で格納               |
| `0x05`   | `binary`             | 下記「バイナリ形式」形式で格納               |

---

### 値部

型コードに応じて、値の構造は以下の通りです：

#### 型コード `0x01`（int64）
- 8バイトの符号付き整数（big endian）

#### 型コード `0x02`（uint64）
- 8バイトの符号なし整数（big endian）

#### 型コード `0x03`（float64）
- 8バイト、IEEE754 倍精度浮動小数点数（double, big endian）

#### 型コード `0x04`（string）可変長文字列
```
[文字列長 (4バイト)] + [UTF-8文字列本体]
```
- 文字列長は unsigned int（big endian）

#### 型コード `0x05`（binary）バイナリ形式
```
[データ長 (4バイト)] + [バイナリデータ]
```
- データ長は unsigned int（big endian）

---
